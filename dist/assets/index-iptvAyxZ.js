(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();const F={id:"standard",name:"Standard Time",description:"Gregorian calendar with 24-hour time",category:"standard",tickInterval:1e3,learnMoreUrl:"https://en.wikipedia.org/wiki/Gregorian_calendar",visual:{type:"clock",divisions:12,getHands(e){const t=e.getHours()%12,i=e.getMinutes(),r=e.getSeconds();return{hour:t+i/60,minute:(i+r/60)*(100/60),second:r*(100/60)}}},format(e){return{type:"split",date:{formatted:e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),era:"CE"},time:{formatted:e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}),unitLabels:["hours","minutes","seconds"]}}}},R={id:"epoch-seconds",name:"Unix Epoch",description:"Seconds elapsed since January 1, 1970 00:00:00 UTC",category:"epoch",tickInterval:1e3,learnMoreUrl:"https://en.wikipedia.org/wiki/Unix_time",format(e){return{type:"unified",value:Math.floor(e.getTime()/1e3).toLocaleString(),label:"seconds since epoch",sublabel:"January 1, 1970 00:00:00 UTC"}}},P={id:"kiloseconds",name:"Kiloseconds",description:"SI-prefix time: today measured in kiloseconds",category:"metric",tickInterval:1e3,learnMoreUrl:"https://en.wikipedia.org/wiki/Metric_time",visual:{type:"progress-bar",max:86.4,getValue(e){const t=new Date(e);return t.setHours(0,0,0,0),(e.getTime()-t.getTime())/1e6}},format(e){const t=new Date(e);t.setHours(0,0,0,0);const r=((e.getTime()-t.getTime())/1e3/1e3).toFixed(3),n=Math.floor((e.getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5);return{type:"unified",value:r,suffix:" ks",label:"kiloseconds today",sublabel:`Day ${n} of ${e.getFullYear()}`}}};function L(e){const i=e.getTime()+e.getTimezoneOffset()*6e4+36e5,r=new Date(i),n=new Date(r);return n.setUTCHours(0,0,0,0),(i-n.getTime())/86400}const O={id:"swatch-beats",name:"Swatch Internet Time",description:"Day divided into 1000 .beats, referenced to Biel, Switzerland",category:"metric",tickInterval:86.4,learnMoreUrl:"https://en.wikipedia.org/wiki/Swatch_Internet_Time",visual:{type:"progress-ring",max:1e3,getValue(e){return L(e)}},format(e){return{type:"unified",prefix:"@",value:Math.floor(L(e)).toString().padStart(3,"0"),label:".beats",sublabel:"No time zones. @000 = midnight in Biel."}}},B=["Vendémiaire","Brumaire","Frimaire","Nivôse","Pluviôse","Ventôse","Germinal","Floréal","Prairial","Messidor","Thermidor","Fructidor"],V=["La Fête de la Vertu","La Fête du Génie","La Fête du Travail","La Fête de l'Opinion","La Fête des Récompenses","La Fête de la Révolution"];function q(e){const t=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];let i="";for(const[r,n]of t)for(;e>=r;)i+=n,e-=r;return i}function Y(e){return e<3?!1:e<=20?(e-3)%4===0:e%4===0&&(e%100!==0||e%400===0)}function G(e){const n=new Date(1792,8,22),o=Math.floor((e.getTime()-n.getTime())/864e5);if(o<0)return{year:0,month:0,day:1,isComplementary:!1};let a=o,c=1;for(;;){const g=Y(c)?366:365;if(a<g)break;a-=g,c++}return a>=360?{year:c,month:-1,day:a-360,isComplementary:!0}:{year:c,month:Math.floor(a/30),day:a%30+1,isComplementary:!1}}const X={id:"decimal-french",name:"French Republican",description:"Revolutionary decimal time: 10 hours/day, 100 min/hour, 100 sec/min",category:"cultural",tickInterval:864,learnMoreUrl:"https://en.wikipedia.org/wiki/French_Republican_calendar",visual:{type:"clock",divisions:10,getHands(e){const t=new Date(e);t.setHours(0,0,0,0);const n=(e.getTime()-t.getTime())/864e5*1e5,s=n/1e4,o=n%1e4/100,a=n%100;return{hour:s,minute:o,second:a}}},format(e){const t=G(e),i=new Date(e);i.setHours(0,0,0,0);const n=(e.getTime()-i.getTime())/864e5,s=Math.floor(n*1e5),o=Math.floor(s/1e4),a=Math.floor(s%1e4/100),c=s%100,g=`${o}:${a.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`;let l;return t.isComplementary?l=V[t.day]??`Jour complémentaire ${t.day+1}`:l=`${t.day} ${B[t.month]}`,{type:"split",date:{formatted:l,era:`An ${q(t.year)}`},time:{formatted:g,unitLabels:["heures","minutes décimales","secondes décimales"]},separator:" — "}}},z={id:"holocene",name:"Holocene Era",description:"Adds 10,000 years to represent the Human Era (HE)",category:"calendar",tickInterval:1e3,learnMoreUrl:"https://en.wikipedia.org/wiki/Holocene_calendar",format(e){const t=e.getFullYear()+1e4;return{type:"split",date:{formatted:e.toLocaleDateString("en-US",{month:"long",day:"numeric"})+`, ${t.toLocaleString()}`,era:"HE"},time:{formatted:e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}}}},J=[F,R,P,O,X,z],S=new Map;for(const e of J){if(!K(e)){const t=e.id??"unknown";console.warn(`[Chronoshift] Invalid system definition: ${t}`);continue}if(S.has(e.id)){console.warn(`[Chronoshift] Duplicate system ID: ${e.id}`);continue}S.set(e.id,e)}function K(e){if(!e||typeof e!="object")return!1;const t=e;return typeof t.id=="string"&&typeof t.name=="string"&&typeof t.description=="string"&&typeof t.format=="function"}function j(){return Array.from(S.values())}function H(e){return S.get(e)}function W(){return S.get("standard")??Array.from(S.values())[0]}function Z(e,t){switch(t.innerHTML="",t.className=`display display--${e.type}`,e.type){case"unified":Q(e,t);break;case"split":ee(e,t);break;case"segmented":te(e,t);break}}function Q(e,t){const i=document.createElement("div");if(i.className="display__main",e.prefix){const n=document.createElement("span");n.className="display__prefix",n.textContent=e.prefix,i.appendChild(n)}const r=document.createElement("span");if(r.className="display__value",r.textContent=e.value,i.appendChild(r),e.suffix){const n=document.createElement("span");n.className="display__suffix",n.textContent=e.suffix,i.appendChild(n)}if(t.appendChild(i),e.label){const n=document.createElement("div");n.className="display__label",n.textContent=e.label,t.appendChild(n)}if(e.sublabel){const n=document.createElement("div");n.className="display__sublabel",n.textContent=e.sublabel,t.appendChild(n)}}function ee(e,t){const i=document.createElement("div");if(i.className="display__date",i.textContent=e.date.formatted,e.date.era){const s=document.createElement("span");s.className="display__era",s.textContent=` ${e.date.era}`,i.appendChild(s)}const r=document.createElement("div");if(r.className="display__time",r.textContent=e.time.formatted,e.time.period){const s=document.createElement("span");s.className="display__period",s.textContent=` ${e.time.period}`,r.appendChild(s)}t.appendChild(i);const n=document.createElement("span");n.className="display__separator",n.textContent=e.separator??" • ",t.appendChild(n),t.appendChild(r)}function te(e,t){const i=document.createElement("div");i.className="display__segments",e.segments.forEach((r,n)=>{if(n>0){const c=document.createElement("span");c.className="display__seg-separator",c.textContent=e.separator??":",i.appendChild(c)}const s=document.createElement("div");s.className="display__segment";const o=document.createElement("span");o.className="display__seg-value",o.textContent=String(r.value),s.appendChild(o);const a=document.createElement("span");a.className="display__seg-label",a.textContent=r.label,s.appendChild(a),i.appendChild(s)}),t.appendChild(i)}const d=120,_=4;function ne(e,t,i){switch(e.type){case"progress-bar":se(e,t,i);break;case"progress-ring":ie(e,t,i);break;case"clock":re(e,t,i);break}}function se(e,t,i){const r=e.getValue(t),n=Math.min(r/e.max,1);let s=i.querySelector(".visual__svg");if(!s){s=document.createElementNS("http://www.w3.org/2000/svg","svg"),s.setAttribute("class","visual__svg visual__svg--bar"),s.setAttribute("viewBox",`0 0 ${d} 12`),s.setAttribute("aria-hidden","true");const a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("class","visual__track"),a.setAttribute("x","0"),a.setAttribute("y","4"),a.setAttribute("width",String(d)),a.setAttribute("height","4"),a.setAttribute("rx","2"),s.appendChild(a);const c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("class","visual__fill"),c.setAttribute("x","0"),c.setAttribute("y","4"),c.setAttribute("height","4"),c.setAttribute("rx","2"),s.appendChild(c),i.appendChild(s)}s.querySelector(".visual__fill").setAttribute("width",String(n*d))}function ie(e,t,i){const r=e.getValue(t),n=Math.min(r/e.max,1),s=(d-_)/2,o=2*Math.PI*s;let a=i.querySelector(".visual__svg");if(!a){a=document.createElementNS("http://www.w3.org/2000/svg","svg"),a.setAttribute("class","visual__svg visual__svg--ring"),a.setAttribute("viewBox",`0 0 ${d} ${d}`),a.setAttribute("aria-hidden","true");const l=d/2,m=document.createElementNS("http://www.w3.org/2000/svg","circle");m.setAttribute("class","visual__track"),m.setAttribute("cx",String(l)),m.setAttribute("cy",String(l)),m.setAttribute("r",String(s)),m.setAttribute("fill","none"),m.setAttribute("stroke-width",String(_)),a.appendChild(m);const u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.setAttribute("class","visual__fill"),u.setAttribute("cx",String(l)),u.setAttribute("cy",String(l)),u.setAttribute("r",String(s)),u.setAttribute("fill","none"),u.setAttribute("stroke-width",String(_)),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-dasharray",String(o)),u.setAttribute("transform",`rotate(-90 ${l} ${l})`),a.appendChild(u),i.appendChild(a)}const c=a.querySelector(".visual__fill"),g=o*(1-n);c.setAttribute("stroke-dashoffset",String(g))}function re(e,t,i){const r=e.getHands(t),n=d/2,s=(d-_)/2;let o=i.querySelector(".visual__svg");if(!o){o=document.createElementNS("http://www.w3.org/2000/svg","svg"),o.setAttribute("class","visual__svg visual__svg--clock"),o.setAttribute("viewBox",`0 0 ${d} ${d}`),o.setAttribute("aria-hidden","true");const b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.setAttribute("class","visual__face"),b.setAttribute("cx",String(n)),b.setAttribute("cy",String(n)),b.setAttribute("r",String(s)),b.setAttribute("fill","none"),b.setAttribute("stroke-width",String(_)),o.appendChild(b);for(let p=0;p<e.divisions;p++){const A=(p/e.divisions*360-90)*Math.PI/180,N=s-8,D=s-3,v=document.createElementNS("http://www.w3.org/2000/svg","line");v.setAttribute("class","visual__marker"),v.setAttribute("x1",String(n+N*Math.cos(A))),v.setAttribute("y1",String(n+N*Math.sin(A))),v.setAttribute("x2",String(n+D*Math.cos(A))),v.setAttribute("y2",String(n+D*Math.sin(A))),v.setAttribute("stroke-width","2"),v.setAttribute("stroke-linecap","round"),o.appendChild(v)}const h=document.createElementNS("http://www.w3.org/2000/svg","line");h.setAttribute("class","visual__hand visual__hand--hour"),h.setAttribute("x1",String(n)),h.setAttribute("y1",String(n)),h.setAttribute("stroke-width","3"),h.setAttribute("stroke-linecap","round"),o.appendChild(h);const f=document.createElementNS("http://www.w3.org/2000/svg","line");if(f.setAttribute("class","visual__hand visual__hand--minute"),f.setAttribute("x1",String(n)),f.setAttribute("y1",String(n)),f.setAttribute("stroke-width","2"),f.setAttribute("stroke-linecap","round"),o.appendChild(f),r.second!==void 0){const p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("class","visual__hand visual__hand--second"),p.setAttribute("x1",String(n)),p.setAttribute("y1",String(n)),p.setAttribute("stroke-width","1"),p.setAttribute("stroke-linecap","round"),o.appendChild(p)}const y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.setAttribute("class","visual__center"),y.setAttribute("cx",String(n)),y.setAttribute("cy",String(n)),y.setAttribute("r","3"),o.appendChild(y),i.appendChild(o)}const a=r.hour/e.divisions*360-90,c=r.minute/100*360-90,g=a*Math.PI/180,l=c*Math.PI/180,m=s*.5,u=s*.7,M=o.querySelector(".visual__hand--hour");M.setAttribute("x2",String(n+m*Math.cos(g))),M.setAttribute("y2",String(n+m*Math.sin(g)));const I=o.querySelector(".visual__hand--minute");if(I.setAttribute("x2",String(n+u*Math.cos(l))),I.setAttribute("y2",String(n+u*Math.sin(l))),r.second!==void 0){const h=(r.second/100*360-90)*Math.PI/180,f=s*.8,y=o.querySelector(".visual__hand--second");y&&(y.setAttribute("x2",String(n+f*Math.cos(h))),y.setAttribute("y2",String(n+f*Math.sin(h))))}}function oe(e){const t=e.querySelector(".visual__svg");t&&t.remove()}const x=document.getElementById("system-selector"),$=document.getElementById("time-visual"),ae=document.getElementById("time-display"),k=document.getElementById("learn-more");let w=W(),E;function ce(){const e=j();for(const t of e){const i=document.createElement("option");i.value=t.id,i.textContent=t.name,i.title=t.description,x.appendChild(i)}}function C(){const e=new Date,t=w.format(e);Z(t,ae),w.visual&&ne(w.visual,e,$)}function U(){w.learnMoreUrl?(k.href=w.learnMoreUrl,k.style.display=""):k.style.display="none"}function T(e){const t=H(e);t&&(oe($),w=t,clearInterval(E),C(),E=window.setInterval(C,t.tickInterval??1e3),U(),localStorage.setItem("chronoshift-system",e))}function le(){ce();const e=localStorage.getItem("chronoshift-system");e&&H(e)?(x.value=e,T(e)):(C(),E=window.setInterval(C,w.tickInterval??1e3),U()),x.addEventListener("change",t=>{T(t.target.value)})}le();
